<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="build-version" content="2026-02-20_UI-V4_FINAL" />
    <title>STOCK IA PRO ‚Äî Asistente inteligente</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- MANIFEST PWA -->
    <link rel="manifest" href="manifest.json" />

    <!-- ESTILOS PRINCIPALES -->
    <link rel="stylesheet" href="styles_v2.css?v=20260225" />

    <!-- ESTILO AISLADO DEL SCANNER -->
    <link rel="stylesheet" href="scanner.css?v=20260223" />

    <script>
      console.log(
        "%cBUILD VERSION: 2026-02-20_UI-V4_FINAL",
        "color:#4f8cff;font-size:14px;font-weight:bold"
      );
    </script>
  </head>

  <body>
    <div id="build-version" style="display:none">2026-02-20_UI-V4_FINAL</div>

    <div class="app-shell">
      <div class="app-container">

        <!-- HEADER -->
        <header class="app-header">
          <div class="branding">
            <div class="brand-orb-mini">IA</div>
            <div>
              <div class="brand-title">STOCK IA PRO</div>
              <div class="brand-subtitle">Asistente inteligente de stock</div>
            </div>
          </div>

          <div class="header-right">
            <div class="connection-indicator">
              <span class="connection-dot" id="connection-dot"></span>
              <span>Estado conexi√≥n</span>
            </div>

            <div class="header-switch-row">
              <label class="orb-mode-switch">
                <span>Modo d√≠a</span>
                <label class="switch small">
                  <input id="toggle-dark" type="checkbox" />
                  <span class="slider"></span>
                </label>
                <span>Noche</span>
              </label>
            </div>

            <button id="help-button" class="btn-help">‚ùì</button>
          </div>
        </header>

        <!-- SEARCH + ORB -->
        <section class="search-card">
          <div id="search-status" class="search-status">Listo</div>

          <div class="search-row">
            <div class="search-input-wrapper">
              <input
                id="search-input"
                type="text"
                class="search-input"
                placeholder="Buscar art√≠culo, marca, rubro, talle, color, precio..."
                autocomplete="off"
              />
              <ul id="autocomplete-list" class="autocomplete-list"></ul>
            </div>
          </div>

          <!-- SCANNER BUTTONS -->
          <div class="scanner-buttons">
            <button id="btn-scanner-interno-1" class="scanner-button">üì∑</button>
            <button id="btn-scanner-externo-preferido" class="scanner-button">üì≤</button>
          </div>

          <!-- SCANNER MODE -->
          <div class="scanner-mode-switch">
            <label class="orb-mode-switch">
              <span>Simple</span>
              <label class="switch small">
                <input id="scanner-mode-switch" type="checkbox" />
                <span class="slider"></span>
              </label>
              <span>Completo</span>
            </label>
          </div>

          <div class="search-actions-row">
            <button id="btn-limpiar" class="orb-action-btn">üßπ</button>
            <button id="btn-copiar" class="orb-action-btn">üìã</button>
            <button id="btn-stop" class="orb-action-btn stop">‚èπ</button>
          </div>

          <div class="voice-row">
            <button id="mic-button" class="mic-btn">üé§</button>

            <label class="orb-mode-switch">
              <span>Dictado</span>
              <label class="switch small">
                <input id="modo-voz-switch" type="checkbox" />
                <span class="slider"></span>
              </label>
            </label>

            <label class="orb-mode-switch">
              <span>Manos libres</span>
              <label class="switch small">
                <input id="modo-manos-libres" type="checkbox" />
                <span class="slider"></span>
              </label>
            </label>
          </div>

          <div id="voice-status" class="voice-status">Dictado desactivado</div>

          <!-- FILTROS -->
          <div class="search-filters-row">
            <label class="solo-stock">
              <span>Solo con stock</span>
              <label class="switch">
                <input id="chk-solo-stock" type="checkbox" />
                <span class="slider"></span>
              </label>
            </label>

            <button id="btn-filtros" class="btn-secondary">Filtros</button>
          </div>

          <!-- ORB -->
          <div class="orb-zone">
            <div class="orb-actions-ring">
              <div id="orb-core" class="orb-ultra"></div>
            </div>
          </div>

          <!-- M√âTRICAS -->
          <div class="metrics-row">
            <div id="metric-articulos" class="metric-card">
              <div class="metric-label">Art√≠culos</div>
              <div class="metric-value" id="metric-articulos-value">0</div>
            </div>

            <div id="metric-pares" class="metric-card">
              <div class="metric-label">Unidades</div>
              <div class="metric-value" id="metric-pares-value">0</div>
            </div>

            <div id="metric-alertas-negativos" class="metric-card">
              <div class="metric-label">Stock negativo</div>
              <div class="metric-value" id="metric-alertas-negativos-value">0</div>
            </div>

            <div id="metric-alertas-cero" class="metric-card">
              <div class="metric-label">Sin stock</div>
              <div class="metric-value" id="metric-alertas-cero-value">0</div>
            </div>

            <div id="metric-ultima-unidad" class="metric-card">
              <div class="metric-label">√öltima unidad</div>
              <div class="metric-value" id="metric-ultima-unidad-value">0</div>
            </div>

            <div id="metric-valorizado" class="metric-card">
              <div class="metric-label">Valorizado</div>
              <div class="metric-value" id="metric-valorizado-value">$0</div>
            </div>
          </div>

          <!-- PANEL DE FILTROS -->
          <div id="filtros-panel" class="filtros-panel">
            <div class="filtros-row filtros-row-stack">
              <select id="filtro-marca" class="filtro-select">
                <option value="">Marca</option>
              </select>

              <select id="filtro-rubro" class="filtro-select">
                <option value="">Rubro</option>
              </select>
            </div>

            <div class="filtros-row filtros-row-stack">
              <input id="filtro-talle-desde" type="number" class="filtro-input" placeholder="Talle desde" />
              <input id="filtro-talle-hasta" type="number" class="filtro-input" placeholder="Talle hasta" />
            </div>

            <div class="filtros-row filtros-row-stack">
              <input id="filtro-unidades-desde" type="number" class="filtro-input" placeholder="Unidades desde" />
              <input id="filtro-unidades-hasta" type="number" class="filtro-input" placeholder="Unidades hasta" />
            </div>

            <div class="filtros-row">
              <button id="btn-aplicar-filtros" class="btn-secondary">Aplicar filtros</button>
            </div>
          </div>
        </section>

        <!-- MAIN ROW -->
        <section class="main-row">
          <div class="results-card">
            <div class="results-header">
              <div class="results-title">Resultados</div>

              <div class="results-right">
                <div class="results-view-toggle">
                  <button id="btn-ver-tabla" class="view-btn">Tabla</button>
                  <button id="btn-ver-tarjetas" class="view-btn active">Tarjetas</button>
                  <button id="btn-ver-articulo" class="view-btn">Art√≠culo</button>
                </div>
              </div>
            </div>

            <div id="results-status" class="results-status">Esperando consulta</div>

            <div id="results-container">
              <div id="vista-tabla" class="vista active"></div>
              <div id="vista-tarjeta" class="vista"></div>
              <div id="vista-articulo" class="vista"></div>
            </div>
          </div>

          <!-- DASHBOARD -->
          <aside class="dashboard-card">
            <div class="dashboard-header">
              <div class="dashboard-title">Visi√≥n r√°pida</div>
              <div class="dashboard-subtitle">Distribuci√≥n por talle / marca / rubro</div>
            </div>

            <select id="chart-mode">
              <option value="talle">Por talle</option>
              <option value="marca">Por marca</option>
              <option value="rubro">Por rubro</option>
            </select>

            <div class="chart-type-row">
              <button class="chart-type-btn active" data-chart-type="pie">Torta</button>
              <button class="chart-type-btn" data-chart-type="bar">Barra</button>
              <button class="chart-type-btn" data-chart-type="line">L√≠neas</button>
              <button class="chart-type-btn" data-chart-type="doughnut">Doughnut</button>
              <button class="chart-type-btn" data-chart-type="polarArea">Polar</button>
            </div>

            <canvas id="stockChart"></canvas>
          </aside>
        </section>

        <!-- SCANNER OVERLAY -->
        <div id="scanner-overlay" class="hidden">
          <video id="scanner-video" autoplay playsinline></video>
          <div id="focus-ring"></div>
          <div id="scan-frame"></div>
          <div id="scan-laser"></div>
        </div>

        <!-- FUENTE DE DATOS -->
        <section class="fuente-datos-wrapper">
          <button id="fuente-datos-toggle" class="btn-secondary">Fuente de datos</button>

          <div id="fuente-datos-panel" class="fuente-datos-panel hidden">
            <div><strong>Archivo:</strong> <span id="fuente-archivo">‚Äî</span></div>
            <div><strong>Fecha:</strong> <span id="fuente-fecha">‚Äî</span></div>
            <div><strong>Marcas:</strong> <span id="fuente-marcas">‚Äî</span></div>
            <div><strong>Rubros:</strong> <span id="fuente-rubros">‚Äî</span></div>
            <div><strong>Art√≠culos:</strong> <span id="fuente-articulos">‚Äî</span></div>
            <div><strong>Stock total:</strong> <span id="fuente-stock-total">‚Äî</span></div>
            <div><strong>Stock negativo:</strong> <span id="fuente-stock-negativo">‚Äî</span></div>
          </div>
        </section>

        <!-- FOOTER -->
        <footer class="app-footer">
          <div class="footer-left">
            <div class="footer-logo">SCL</div>
            <div class="footer-text">Salas Creative Lab</div>
          </div>

          <div class="footer-right">
            <span id="version-badge" class="version-badge">v0.0.0</span>
          </div>
        </footer>

      </div>
    </div>

    <!-- PANEL ADMIN -->
    <div id="admin-panel" class="hidden">
      <h2 class="admin-title">Panel administrador</h2>

      <div class="admin-group">
        <label class="admin-label">URL backend</label>
        <input id="admin-backend-url" type="text" class="admin-input" />
      </div>

      <div class="admin-group">
        <label class="admin-label">Modo por defecto</label>
        <select id="admin-modo-defecto" class="admin-select">
          <option value="simple">Simple</option>
          <option value="completo">Completo</option>
        </select>
      </div>

      <div class="admin-divider"></div>

      <div class="admin-section-title">ORB ‚Äî Apariencia</div>

      <div class="admin-group">
        <label class="admin-label">Color d√≠a</label>
        <input id="orb-color" type="color" class="admin-input" />
      </div>

      <div class="admin-group">
        <label class="admin-label">Color noche</label>
        <input id="orb-color-dark" type="color" class="admin-input" />
      </div>

      <div class="admin-group">
        <label class="admin-label">Tama√±o ORB (px)</label>
        <input id="orb-size" type="range" min="80" max="200" class="admin-slider" />
      </div>

      <div class="admin-group">
        <label class="admin-label">Intensidad halo</label>
        <input id="orb-halo" type="range" min="0" max="120" class="admin-slider" />
      </div>

      <div class="admin-group">
        <label class="admin-label">Modo visual</label>
        <select id="orb-mode" class="admin-select">
          <option value="ultra">Ultra</option>
          <option value="3d">3D</option>
          <option value="classic">Classic</option>
        </select>
      </div>

      <div class="admin-group">
        <label class="admin-label">Presets</label>
        <select id="orb-presets" class="admin-select">
          <option value="default">Default</option>
          <option value="plasma">Plasma</option>
          <option value="fuego">Fuego</option>
          <option value="neon">Ne√≥n</option>
          <option value="minimal">Minimal</option>
        </select>
      </div>

      <button id="orb-reset">Reset ORB</button>

      <div class="admin-actions">
        <button id="admin-guardar">Guardar</button>
        <button id="admin-cerrar">Cerrar</button>
      </div>
    </div>

    <!-- MODAL DE AYUDA -->
    <div id="help-modal" class="help-modal hidden">
      <div class="help-modal-content">
        <h2>Ayuda r√°pida</h2>
        <ul>
          <li>Escrib√≠ o escane√° un c√≥digo, marca, rubro o talle.</li>
          <li>Us√° el bot√≥n üé§ si el modo dictado est√° activo.</li>
          <li>Activ√° manos libres para consultas continuas.</li>
          <li>Us√° ‚ÄúSolo con stock‚Äù y ‚ÄúFiltros‚Äù para acotar resultados.</li>
          <li>Click en m√©tricas para entender el stock global.</li>
          <li>Atajos: ESC limpia, F2 scanner, F3 voz.</li>
        </ul>
        <button id="help-close" class="help-close-btn">Cerrar</button>
      </div>
    </div>

    <div id="toast" class="toast"></div>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- SCANNER V7 NATIVO -->
    <script src="scanner_v7_barcodeDetector.js?v=20260226"></script>

    <!-- RESTO DE LA APP -->
    <script src="app_core_v4.js?v=20260220"></script>
    <script src="ui_engine_v4.js?v=20260220"></script>
    <script src="orb_engine_v2.js?v=20260220"></script>
    <script src="orb_admin_engine.js?v=20260220"></script>
    <script src="dashboard_engine.js?v=20260220"></script>
    <script src="indicators_engine.js?v=20260220"></script>

    <script>
      window.addEventListener("DOMContentLoaded", () => {
        if (window.appCore && window.initUI) {
          initUI(appCore);
        }
      });
    </script>
  </body>
</html>
